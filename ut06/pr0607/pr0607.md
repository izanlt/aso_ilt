1.- Objetivo
Trabajas como Administrador de Sistemas en la empresa TechIberia S.L.. El departamento de Recursos Humanos utiliza una aplicación antigua para registrar a las nuevas incorporaciones.

Cada lunes, RRHH te envía un fichero de texto plano con los datos de los nuevos empleados. Lamentablemente, el formato de salida de su aplicación es caótico: todo está en mayúsculas, los delimitadores son extraños y los campos están mezclados.

Tu objetivo es crear un script en PowerShell que lea estos datos “sucios”, los procese utilizando manipulación de cadenas y exporte un archivo CSV limpio y profesional listo para ser importado a Active Directory o Microsoft 365.

2. Datos de Entrada
Crea un fichero llamado nuevos_empleados_raw.txt con el siguiente contenido exacto (copia y pega):

GARCIA LOPEZ, ANA MARIA|MAD-VENTAS-01|1995/05/12
RUIZ DE LA TORRE, PEDRO|BCN-IT_SOPORTE-02|1988/11/23
O'CONNOR, SARAH JANE|BIO-MARKETING-05|2001/02/15
MARTINEZ, JOSE|SEV-LOGISTICA-09|1999/12/30

3. Requerimientos técnicos
El script debe leer el fichero línea por línea y realizar las siguientes transformaciones de cadena para cada empleado:

Nombre y apellidos:
El formato original es APELLIDOS, NOMBRE en mayúsculas.
Debes separarlos y convertirlos a Title Case (primera letra mayúscula, resto minúscula).
Ejemplo: “Ana Maria Garcia Lopez”.
Generación de nombre de usuario (SAMAccountName):
Debe formarse con: la primera letra del nombre + las primeras 6 letras del primer apellido.
Todo en minúsculas.
Si el apellido tiene menos de 6 letras, no debe dar error, debe coger las que tenga.
Generación de correo electrónico:
Formato: nombre.apellido@techiberia.com.
Si el nombre o apellido es compuesto, reemplaza los espacios por puntos (ej: ana.maria.garcia.lopez@techiberia.com).
Departamento y ubicación:
El código original es CIUDAD-DEPARTAMENTO-ID.
Debes extraer solo el nombre del departamento (lo que está en el medio).
Debes limpiar el texto (ej: convertir IT_SOPORTE a It Soporte o simplemente IT_SOPORTE, pero sin la ciudad ni el ID).
Contraseña temporal:
Debe ser la palabra ChangeMe + el año de nacimiento + el símbolo !.
Para esto necesitas extraer el año de la fecha proporcionada.
4. Salida Esperada
El script debe generar un archivo llamado usuarios_importar.csv que contenga objetos con las siguientes columnas:

| NombreCompleto         | Usuario | Email        | Departamento | PasswordInicial |
| ---------------------- | ------- | ------------ | ------------ | --------------- |
| Ana Maria Garcia Lopez | agarcia | ana.maria... | VENTAS       | ChangeMe1995!   |


$usuarios = Get-Content "nuevos_empleados_raw.txt"

$resultado = foreach ($linea in $usuarios) {

    # Separar campos principales
    $campos = $linea -split " | "
    $nombreRaw = $campos[0]
    $codigo = $campos[1]
    $fechaNacimiento = $campos[2]

    # NOMBRE COMPLETO

    # Formato: APELLIDOS, NOMBRE
    $partesNombre = $nombreRaw -split ","
    $apellidos = $partesNombre[0].Trim()
    $nombres = $partesNombre[1].Trim()

    $textoInfo = (Get-Culture).TextInfo
    $nombreCompleto = $textoInfo.ToTitleCase(
        "$nombres $apellidos".ToLower()
    )


    # USUARIO (SAMAccountName)

    $primerNombre = $nombres.Split(' ')[0]
    $primerApellido = $apellidos.Split(' ')[0]

    $usuario = (
        $primerNombre.Substring(0,1) +
        $primerApellido.Substring(0, [Math]::Min(6, $primerApellido.Length))
    ).ToLower()


    # EMAIL

    $emailNombre = ($nombres -replace ' ', '.').ToLower()
    $emailApellido = ($apellidos -replace ' ', '.').ToLower()
    $email = "$emailNombre.$emailApellido@techiberia.com"


    # DEPARTAMENTO

    $codigoPartes = $codigo -split '-'
    $departamento = $codigoPartes[1]


    # PASSWORD INICIAL

    $anioNacimiento = (Get-Date $fechaNacimiento).Year
    $password = "ChangeMe$anioNacimiento!"


    # OBJETO FINAL
          
    [PSCustomObject]@{
        NombreCompleto    = $nombreCompleto
        Usuario           = $usuario
        Email             = $email
        Departamento      = $departamento
        PasswordInicial   = $password
    }
}

# Exportar CSV
$resultado | Export-Csv "usuarios_importar.csv" -NoTypeInformation -Encoding UTF8